---
title: "Explicit Learning and Localization Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r echo=FALSE}
source("explicitFunctions.R")
```

All data files are saved as csv files in the data directory. There are indiual files for each task and each group.

# Learning Curves

## Import adaptation data
Reach angles per trial, per participant.

```{r}
adaptationDF <- LoadReachData()
```


First, we should see if people learn.  

## Effects of instruction and rotation size on learning
Second, we look for effects of instruction or rotation size on block by block learning (called "trial sets" in the manuscript; 3 trials each).  

```{r warning=FALSE}
blockedLCANOVA <- ezANOVA(data=adaptationDF, dv=meanDeviation, wid=participant, 
                         within=.(block), between=.(instruction, rotationSize), 
                         return_aov=TRUE, type=3)
blockedLCANOVA$ANOVA$p <-format(round(blockedLCANOVA$ANOVA$p, 3), nsmall = 2)
blockedLCANOVA$ANOVA$F <-format(round(blockedLCANOVA$ANOVA$F, 4), nsmall = 2)
print(blockedLCANOVA$ANOVA)
```
__Note: does the main effect of block here tell us that there is learning?  __
The interactions on rows 6 and 7 tell us that both instruction and rotation size interact with block by block learning.  
However, this doesn't tell us where the interaction lies; Tukey's can tell us where, OR... 

## Main effects of instruction or rotation size in block 1 

2x2 ANOVA
```{r warning=FALSE, message=FALSE}
block1DF <- adaptationDF[adaptationDF$block == "block1", ]
block1ANOVA <- ezANOVA(data=block1DF, dv=meanDeviation, wid=participant, 
                         between=.(instruction, rotationSize), 
                         return_aov=TRUE, type=3)
block1ANOVA$ANOVA$p <-format(round(block1ANOVA$ANOVA$p, 3), nsmall = 2)
block1ANOVA$ANOVA$F <-format(round(block1ANOVA$ANOVA$F, 4), nsmall = 2)
print(block1ANOVA$ANOVA)
```


## Main effects of instruction or rotation size in block 1 

2x2 ANOVA
```{r warning=FALSE, message=FALSE}
block2DF <- adaptationDF[adaptationDF$block == "block2", ]
block2ANOVA <- ezANOVA(data=block2DF, dv=meanDeviation, wid=participant, 
                         between=.(instruction, rotationSize), 
                         return_aov=TRUE, type=3)
block2ANOVA$ANOVA$p <-format(round(block2ANOVA$ANOVA$p, 3), nsmall = 2)
block2ANOVA$ANOVA$F <-format(round(block2ANOVA$ANOVA$F, 4), nsmall = 2)
print(block2ANOVA$ANOVA)
```


## Repeat stats on learning curves normalized for rotation size.  

***

# Reach After Effects

## Import aftereffects data
Median angular deviation of the hand from target direction of each participant during open-loop reaches.  
afterEffectsDF contains __baseline-corrected__ aftereffects recorded during the 'Rotated' session.  
withoutStratAEDF contains aftereffects recorded during both sessions when participants do not employ a concious strategy, __with no baseline corrections__.  

```{r}
afterEffectsDF <- LoadAEData()
withoutStratAEDF <- LoadAEData_NoBLCorr()
```

## Analysis of variance

First, we confirm that adaptation led to after effects. When we compare open-loop reaches where participants don't conciously employ a strategy, they should perform differently in the 'Rotated' session when compared to the 'Aligned' session.  

__Note: we are just interested in the main effect of session. Should this even include instruction and rotation size?__

```{r warning=FALSE}
sessionAEAOV <- ezANOVA(data=withoutStratAEDF, dv=reachAE, wid=participant, 
                         within=.(session), between=.(instruction, rotationSize), 
                         return_aov=TRUE, type=3)
sessionAEAOV$ANOVA$p <-format(round(sessionAEAOV$ANOVA$p, 3), nsmall = 2)
sessionAEAOV$ANOVA$F <-format(round(sessionAEAOV$ANOVA$F, 4), nsmall = 2)
print(sessionAEAOV$ANOVA)
```
Note that there are no session x intruction or session x rotation size interactions -- all groups had similar implicit afteffects.

After confirming the presense of aftereffects, we test if instructions/rotation size brought about explicit learning.
We perform an ANOVA with rotation size and instruction type as between-subject factors, and strategy use (employing or not employing a strategy when reacing) as a within-subject factor.

```{r warning=FALSE}
aeANOVA <- ezANOVA(data=afterEffectsDF, dv=reachAE, wid=participant, 
                   within=stratUse, between=.(instruction, rotationSize), 
                   return_aov=TRUE, type=3)
aeANOVA$ANOVA$p <-format(round(aeANOVA$ANOVA$p, 3), nsmall = 2)
aeANOVA$ANOVA$F <-format(round(aeANOVA$ANOVA$F, 4), nsmall = 2)

print(aeANOVA$ANOVA)
```

## T-tests

T-tests are conducted (4 t-tests, one for each group), comparing aftereffects when using a strategy vs when not using one in the 'Rotated' session.

Non-instructed 30° group
```{r}
t.test(subset(afterEffectsDF, (instruction == 'non-instructed') & (rotationSize == 30) & (stratUse == 'without'), select = reachAE ), subset(afterEffectsDF, (instruction == 'non-instructed') & (rotationSize == 30) & (stratUse == 'with'), select = reachAE ))

```

Instructed 30° group
```{r}
t.test(subset(afterEffectsDF, (instruction == 'instructed') & (rotationSize == 30) & (stratUse == 'without'), select = reachAE ), subset(afterEffectsDF, (instruction == 'instructed') & (rotationSize == 30) & (stratUse == 'with'), select = reachAE ))

```

Non-instructed 60° group
```{r}
t.test(subset(afterEffectsDF, (instruction == 'non-instructed') & (rotationSize == 60) & (stratUse == 'without'), select = reachAE ), subset(afterEffectsDF, (instruction == 'non-instructed') & (rotationSize == 60) & (stratUse == 'with'), select = reachAE ))

```

Instructed 60° group
```{r}
t.test(subset(afterEffectsDF, (instruction == 'instructed') & (rotationSize == 60) & (stratUse == 'without'), select = reachAE ), subset(afterEffectsDF, (instruction == 'instructed') & (rotationSize == 60) & (stratUse == 'with'), select = reachAE ))

```

__Only the non-instructed 30° group did not show significantly different angular deviations when including a strategy.__

***

# Hand Localization

***

# Extra material and testing

```{r}
test <- t.test(subset(afterEffectsDF, (instruction == 'non-instructed') & (rotationSize == 30) & (stratUse == 'without'), select = reachAE ), subset(afterEffectsDF, (instruction == 'non-instructed') & (rotationSize == 30) & (stratUse == 'with'), select = reachAE ))

cat("\nT-test for non-instructed 30° group -- aftereffects with vs without strategy use; mean(sd)")
cat("\n", sprintf("Without: %.3f (%.3f)", test$estimate["mean of x"],
                  sd(subset(afterEffectsDF,
                            (instruction == 'non-instructed')
                            & (rotationSize == 30)
                            & (stratUse == 'without'),
                            select = reachAE)$reachAE)))
cat("\n", sprintf("With: %.3f (%.3f)", as.double(test$estimate["mean of y"]),
                  sd(subset(afterEffectsDF,
                            (instruction == 'non-instructed')
                            & (rotationSize == 30)
                            & (stratUse == 'with'),
                            select = reachAE)$reachAE)))
cat("\n", sprintf("t(%.0f) = %.3f, p = %.3f", test$parameter, test$statistic, test$p.value), "\n\n")

```
